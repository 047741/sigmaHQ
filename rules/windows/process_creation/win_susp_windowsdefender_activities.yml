title: Suspicious Internet Connection of MpCmdRun.exe
id: b0f91552-087e-43ff-aa30-8e1ca2da36ad
description: Detects suspicious activities of MpCmdRun.exe, which could be action for downloading a file from the internet using Windows Defender
status: experimental
references:
    - https://twitter.com/mohammadaskar2/status/1301263551638761477
author: EagleEye Team
date: 2020/09/10
tags:
    - attack.defense_evasion
    - attack.execution
    - attack.t1218
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image|endswith: 'MpCmdRun.exe'
        CommandLine|contains:
          - '-url http'
          - '-downloadfile'
    condition: selection
falsepositives:
    - Unkown
level: high
